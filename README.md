# RhineValleyPesticides
R Code to investigate Current Use Pesticides (CUPs) residues in vegetation, topsoil in the contaminated landscapes of the Upper Rhine Valley in Germany and generate prediction maps for the study area

R code corresponding to:
Current Use Pesticides Residues in Vegetation, Topsoil and Water Reveal Contaminated Landscapes of the Upper Rhine Valley in Germany
https://doi.org/[...]

Data files (files are not part of the repository, these must first be created)
	CLC_CTM_compressed.tif
		Land use raster map of the study area 10 by 10m pixel size
	predpoints1000m.shp
		Shape file with regular spaced prediction Points. Similar to shape
		file with sample Location Points. Both needed in extract6predsinglecore.R
	data_w_toponhisto.xlsx
		Combined data table with each sampling location as a row and the colums v_num
		v_sum s_num and s_sum (number of pesticides and sum concentration for each
		Vegetation (v) and topsoil (s) as well as columns (histogram) for the land 		use types with specific sigma, generated with extract6predsinglecore.R. 		Optional: including topo data if needed in the final models
	Optimal_regression_v_num_2024-02-24_.csv
		Example table of v_num generated by the optimizer and needed for sigma 			decision
	20240109_013809_10963_predpoints1000m.xlsx
		Histogram land use data around the prediction Points for selected Sigmas
		generated generated with extract6predsinglecore.R

Computer code:
	extract6predsinglecore.R
		Extracts the amount of land use around sample locations or 
		prediction Points regarding different sigmas of the normal Distribution
	optimizer_poiss_lm.R
		Finds the optimal sigma for the different land use types
	plot_optimizer_est_num.R
		plot the abundance of detected Sigma optima. Choose Sigmas regarding their		peaks the plots
	predmaps.R
		Generates the prediction maps based on selected land use sigmas		
